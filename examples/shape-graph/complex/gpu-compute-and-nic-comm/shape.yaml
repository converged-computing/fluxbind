# Single-rank application with complex needs.
# The rank needs:
#   1. A GPU
#   2. Four cores that are as close as possible to THAT GPU
#   3. One separate core that is as close as possible to the NIC
resources:
  # First, find one NUMA node that contains at least one GPU.
  - type: numanode
    count: 1
    with:
      - type: gpu
        count: 1
        # Within this NUMA node, find 4 cores close to the GPU we just found.
        with:
          - type: core
            count: 4
            affinity:
              type: gpu
            pattern: packed
  
  # Separately, find one core anywhere on the machine that is close to the NIC.
  - type: machine
    count: 1
    with:
      - type: core
        count: 1
        affinity:
          type: nic
